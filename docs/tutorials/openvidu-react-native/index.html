---
layout: docs-layout
title: OpenVidu Documentation - openvidu-react-native
active: documentation
---

<script src="/js/plugins/jquery.min.js"></script>

<link rel="stylesheet" href="/css/syntax.css" />
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript">
	$(document).ready(function () {
		$('li.subnav_drop').find('ul.subnav').hide();
		$(".subnav").find("li:contains('openvidu-react-native')").each(function (i, e) {
			var currentElement = $(e);
			currentElement.parent().css({
				"display": "block",
				"visibility": "visible"
			}); //css("background-color","blue");
			currentElement.css({
				"display": "block",
				"visibility": "visible"
			});
		});
		$('li.subnav_drop div').click(function (i, e) {
			//$('li.subnav_drop span').not(this).find('ul.subnav').hide();
			$(this).parent().find('ul.subnav').toggle();
		});

		var minHeight = $('#sticky-menu').outerHeight() + 100;
		$('#doc-container').css('min-height', minHeight + 'px');
	});

	$(".wy-nav-content").find("li:contains('openvidu-react-native')").css('color', 'red');
</script>

<div id="doc-container" class="container text-justify">
		<div id="sticky-menu" class="col-lg-3 col-md-4 col-sm-12 col-xs-12">

			
			<nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
				<div class="wy-menu wy-menu-vertical" role="navigation" aria-label="main navigation">
					<div id="site-menu-title">
						<h3>Explore docs</h3>
						<hr>
					</div>
					<ul id="menu-list" class="current">
						 
						<li>
							<ul>

<li class="toctree-l1 ">
        <a class="" href="../../home/">What is OpenVidu?</a> 
</li>

</ul>
						</li>
						  
						<li>
							<ul>

<li  class="subnav_drop">
        <div><span>Tutorials</span></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../">Intro</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-webcomponent/">openvidu-webcomponent</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-hello-world/">openvidu-hello-world</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-insecure-js/">openvidu-insecure-js</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-insecure-angular/">openvidu-insecure-angular</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-library-angular/">openvidu-library-angular</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-insecure-react/">openvidu-insecure-react</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-library-react/">openvidu-library-react</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-ionic/">openvidu-ionic</a> 
</li>

  

<li class="toctree-l1 current">
        <a class="current" href="./">openvidu-react-native</a>  
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-electron/">openvidu-electron</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-js-java/">openvidu-js-java</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-mvc-java/">openvidu-mvc-java</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-js-node/">openvidu-js-node</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../openvidu-mvc-node/">openvidu-mvc-node</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						  
						<li>
							<ul>

<li  class="subnav_drop">
        <div><span>Demos</span></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../../demos/openvidu-getaroom/">openvidu-getaroom</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../demos/openvidu-call/">openvidu-call</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../demos/openvidu-call-react/">openvidu-call-react</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../demos/openvidu-call-ionic/">openvidu-call-ionic</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../demos/openvidu-classroom/">openvidu-classroom</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						  
						<li>
							<ul>

<li  class="subnav_drop">
        <div><span>Cheatsheet</span></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/join-session/">Join a session</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/leave-session/">Leave a session</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/subscribe-unsubscribe/">Subscribe/Unsubscribe from a stream</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/publish-unpublish/">Publish/Unpublish a stream</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/mute-audio-video/">Mute/Unmute audio and video</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/manage-videos/">Manage video players</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/share-data/">Share data between users</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../cheatsheet/send-messages/">Send text messages</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						  
						<li>
							<ul>

<li  class="subnav_drop">
        <div><span>Advanced features</span></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../../advanced-features/recording/">Recording</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../advanced-features/screen-share/">Screen share</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../advanced-features/speech-detection/">Speech detection</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../advanced-features/filters/">Voice and video filters</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						  
						<li>
							<ul>

<li  class="subnav_drop">
        <div><span>Reference Documentation</span></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../../reference-docs/openvidu-browser/">openvidu-browser API</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../reference-docs/openvidu-java-client/">openvidu-java-client API</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../reference-docs/openvidu-node-client/">openvidu-node-client API</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../reference-docs/REST-API/">REST  API</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../reference-docs/openvidu-server-params/">OpenVidu Server configuration</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../reference-docs/openvidu-server-cdr/">OpenVidu Server CDR</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						  
						<li>
							<ul>

<li  class="subnav_drop">
        <div><span>Deployment</span></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../../deployment/deploying-aws/">Deploying OpenVidu on AWS</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../deployment/deploying-ubuntu/">Deploying OpenVidu on Ubuntu</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../deployment/deploying-app/">Deploying your OpenVidu app</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../deployment/upgrading/">Upgrading OpenVidu</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						  
						<li>
							<ul>

<li  class="subnav_drop">
        <div><span>Contribute</span></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../../developing/">Developing OpenVidu</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						  
						<li>
							<ul>

<li class="toctree-l1 ">
        <a class="" href="../../troubleshooting/">Troubleshooting / FAQ</a> 
</li>

</ul>
						</li>
						  
						<li>
							<ul>

<li class="toctree-l1 ">
        <a class="" href="../../releases/">Releases</a> 
</li>

</ul>
						</li>
						  
						<li>
							<ul>

<li  style="width: 100%; display: inline-block"  class="subnav_drop">
        <div><span>OpenVidu Pro</span><a style="all: unset; display: inline"
                        href="/docs/openvidu-pro/">
                        <div id="openvidu-pro-tag" style="float: right; background-color: rgb(0, 136, 170); color: white; font-weight: bold; padding: 0px 5px; border-radius: 3px; font-size: 13px; line-height:21px; font-family: Montserrat, sans-serif;">PRO</div>
                </a></div>
        <ul class="subnav" hidden>
                 

<li class="toctree-l1 ">
        <a class="" href="../../openvidu-pro/">Home</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../openvidu-pro/openvidu-inspector/">OpenVidu Inspector</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../openvidu-pro/detailed-session-monitoring/">Detailed session monitoring</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../openvidu-pro/deploying-openvidu-pro/">Deploying OpenVidu Pro</a> 
</li>

  

<li class="toctree-l1 ">
        <a class="" href="../../openvidu-pro/REST-API-pro/">REST API Pro</a> 
</li>

 
</li>
</ul>

</ul>
						</li>
						 
					</ul>
				</div>
				&nbsp;
			</nav>
		</div>

		<section class="col-lg-9 col-md-8 col-sm-12 col-xs-12">
			
			<div>
				<div>

					<div role="main">
						<div class="section">
							 <h1 id="openvidu-react-native">openvidu-react-native</h1>
<p><a href="https://github.com/OpenVidu/openvidu-tutorials/tree/master/openvidu-react-native" target="_blank"><i class="icon ion-social-github"> Check it on GitHub</i></a></p>
<p>A client-side only application built with <strong>React Native</strong> framework using React and JavaScript. It can be compiled into a <strong>native Android app</strong>, a <strong>native iOS app</strong> .</p>
<p>If it is the first time you use OpenVidu, it is highly recommended to start first with <strong><a href="../../tutorials/openvidu-hello-world/" target="_blank">openvidu-hello-world</a></strong> tutorial due to this being a native app and being a little more complex for OpenVidu starters.</p>
<div style="
    display: table;
    border: 2px solid #ffb600;
    border-radius: 5px;
    width: 100%;
    margin-top: 30px;
    background-color: #FFFBF1;
    margin-bottom: 25px;
    padding: 5px 0 5px 0;
    background-color: rgba(0, 136, 170, 0.04);"><div style="display: table-cell; vertical-align: middle;">
    <i class="icon ion-android-alert" style="
    font-size: 50px;
    color: #ffb600;
    display: inline-block;
    padding-left: 25%;
"></i></div>
<div style="
    vertical-align: middle;
    display: table-cell;
    padding: 10px 20px;">
    <strong>React Native support is a paid feature. A special version of openvidu-browser library is needed for openvidu-react-native tutorial to work. Contact us through <a href="/commercial">Commercial page support</a> to get it</strong>
</div>
</div>

<h2 id="understanding-this-tutorial">Understanding this tutorial</h2>
<p align="center">
  <img class="img-responsive" src="/img/tutorials/openvidu-insecure-react.png">
</p>

<p>OpenVidu is composed by the three modules displayed on the image above in its insecure version.</p>
<ul>
<li><strong>openvidu-browser</strong>: NPM package for your Ionic app. It allows you to manage your video-calls straight away from your clients</li>
<li><strong>openvidu-server</strong>: Java application that controls Kurento Media Server</li>
<li><strong>Kurento Media Server</strong>: server that handles low level operations of media flow transmissions</li>
</ul>
<h2 id="running-this-tutorial">Running this tutorial</h2>
<p>1) You will need <strong>Node 8.3 </strong> or newer, <strong>NPM</strong>, <strong>React Native CLI</strong> to serve the app. Install them with the following command</p>
<pre><code class="bash">sudo curl -sL https://deb.nodesource.com/setup_10.x | sudo bash -
sudo apt-get install -y nodejs
sudo npm install -g react-native-cli
</code></pre>

<p>2) Clone the repo</p>
<pre><code class="bash">git clone https://github.com/OpenVidu/openvidu-tutorials.git
</code></pre>

<p>3) Install dependencies</p>
<pre><code class="bash">cd openvidu-tutorials/openvidu-react-native
npm install
</code></pre>

<p>4) Install openvidu-browser <strong>with React Native support</strong>:
Add the artifact in the root project </p>
<pre><code class="bash">npm install openvidu-browser-Y.Y.Z.tgz
</code></pre>

<div style="
    display: table;
    border: 2px solid #ffb600;
    border-radius: 5px;
    width: 100%;
    margin-top: 30px;
    background-color: #FFFBF1;
    margin-bottom: 25px;
    padding: 5px 0 5px 0;
    background-color: rgba(0, 136, 170, 0.04);"><div style="display: table-cell; vertical-align: middle;">
    <i class="icon ion-android-alert" style="
    font-size: 50px;
    color: #ffb600;
    display: inline-block;
    padding-left: 25%;
"></i></div>
<div style="
    vertical-align: middle;
    display: table-cell;
    padding: 10px 20px;">
    React Native will require OpenVidu Server to be deployed in a valid domain well-protected with a certificate. To facilitate first steps with OpenVidu our demos OpenVidu Server will be used. <strong>Note: this is a publicly accessible OpenVidu Server. Anyone could access your sessions. Use it only for an initial test and under your own responsibility</strong>
</div>
</div>

<div style="
    display: table;
    border: 2px solid #ffb600;
    border-radius: 5px;
    width: 100%;
    margin-top: 30px;
    background-color: #FFFBF1;
    margin-bottom: 25px;
    padding: 5px 0 5px 0;
    background-color: rgba(0, 136, 170, 0.04);"><div style="display: table-cell; vertical-align: middle;">
    <i class="icon ion-android-alert" style="
    font-size: 50px;
    color: #ffb600;
    display: inline-block;
    padding-left: 25%;
"></i></div>
<div style="
    vertical-align: middle;
    display: table-cell;
    padding: 10px 20px;">
    Some problems have been encountered while streaming with iOS devices in some networks with complex restrictions. With mobile networks (4G) these problems have not taken place. Make sure there is no problem with the network you are using in your development environment before posting issues about it
</div>
</div>

<p>Now depending on the platform you want to run your app...</p>
<h4 id="in-an-android-device">In an Android device</h4>
<div style="
    display: table;
    border: 2px solid #0088aa9e;
    border-radius: 5px;
    width: 100%;
    margin-top: 30px;
    margin-bottom: 25px;
    padding: 5px 0 5px 0;
    background-color: rgba(0, 136, 170, 0.04);"><div style="display: table-cell; vertical-align: middle;">
    <i class="icon ion-android-alert" style="
    font-size: 50px;
    color: #0088aa;
    display: inline-block;
    padding-left: 25%;
"></i></div>
<div style="
    vertical-align: middle;
    display: table-cell;
    padding-left: 20px;
    padding-right: 20px;
    ">
    This tutorial has been tested from Android 5.1 (Lollipop) to Android 9 (Pie)
</div>
</div>

<p>To deploy the Android APK not only you need to have <strong>Java JDK8</strong>, <strong>Android Studio</strong> and <strong>Android SDK</strong> installed but also you have to set up the specific <strong>environment variables</strong>. Fortunately, React Native provide us a <a href="https://facebook.github.io/react-native/docs/getting-started" target="_blank">great guide</a> to allows us to configure step by step all the requirements. This tutorial is made with <strong>React Native CLI Quickstart</strong> so you should select and check the <strong>React Native CLI</strong> requirements inside of React guide website.</p>
<p>After we have completed all the steps of the React Native CLI guide and performed steps 1) , 2) and 3) stated above, we must continue with the following commands:</p>
<p>4) Connect the device to the PC. You must enable USB debugging and give permissions (check out <a href="https://facebook.github.io/react-native/docs/running-on-device" target="_blank">first section here in React Native docs</a>)</p>
<p>5) Run the tutorial. The app will be automatically launched in your Android device</p>
<pre><code class="bash"># In openvidu-tutorials/openvidu-react-native
react-native run-android
</code></pre>

<h4 id="in-an-ios-device">In an iOS device</h4>
<div style="
    display: table;
    border: 2px solid #0088aa9e;
    border-radius: 5px;
    width: 100%;
    margin-top: 30px;
    margin-bottom: 25px;
    padding: 5px 0 5px 0;
    background-color: rgba(0, 136, 170, 0.04);"><div style="display: table-cell; vertical-align: middle;">
    <i class="icon ion-android-alert" style="
    font-size: 50px;
    color: #0088aa;
    display: inline-block;
    padding-left: 25%;
"></i></div>
<div style="
    vertical-align: middle;
    display: table-cell;
    padding-left: 20px;
    padding-right: 20px;
    ">
    This tutorial has been tested with Xcode (10.2.1) and iPhone 7 (iOS 12.2), iPhone 7 Plus (iOS 12.1) and iPad Air (iOS 12.1.1)
</div>
</div>

<p>After we have completed all the steps of the performed steps 1), 2) and 3) stated above, we must continue with the following commands:</p>
<p>4) Plug in your device via USB</p>
<p>5) Configure code signing</p>
<p>6) Build and Run your app</p>
<p>To deploy the iOS app React has <a href="https://facebook.github.io/react-native/docs/running-on-device">this guide</a> to properly configure your development environment.</p>
<h2 id="understanding-the-code">Understanding the code</h2>
<p>This is a React Native project generated with React Native CLI tool, and therefore you will see lots of configuration files and other stuff that doesn't really matter to us. We will focus on the following files under <code>App.js</code> file:</p>
<ul>
<li><code>App.js</code>: defines <em>App</em> component, main component of the app. It contains the functionalities for joining a video-call and for handling the video-calls themselves.</li>
</ul>
<p>Let's see first how <code>App.js</code> uses NPM package <code>openvidu-browser</code>:</p>
<hr />
<h4 id="we-import-the-necessary-objects-from-openvidu-browser">We import the necessary objects from <code>openvidu-browser</code>:</h4>
<pre><code class="javascript">import { OpenVidu } from 'openvidu-browser';
</code></pre>

<hr />
<h4 id="appjs-declares-the-following-properties-in-the-state"><code>App.js</code> declares the following properties in the state:</h4>
<pre><code class="javascript">this.state = {
    mySessionId: 'SessionReactNative',
    myUserName: 'Participant' + Math.floor(Math.random() * 100),
    session: undefined,
    mainStreamManager: undefined,
    publisher: undefined,
    subscribers: [],
    role: 'PUBLISHER',
};
</code></pre>

<p><code>OpenVidu</code> object will allow us to get a <code>Session</code> object, which is declared just after it. <code>publisher</code> will be our own local webcam stream and <code>subscribers</code> array will store the active streams of other users in the video-call. Finally, <code>mySessionId</code> and <code>myUserName</code> params simply represent the video-call and your participant's nickname, as you will see in a moment.</p>
<hr />
<h4 id="whenever-a-user-clicks-on-the-join-button-defined-in-appjs-joinsession-method-is-called">Whenever a user clicks on the join button defined in <code>App.js</code>, <code>joinSession()</code> method is called:</h4>
<p><br></p>
<p>We first get an OpenVidu object and initialize a session property inside the state.</p>
<pre><code class="javascript">// --- 1) Get an OpenVidu object ---

this.OV = new OpenVidu();

// --- 2) Init a session ---

this.setState({
    session: this.OV.initSession(),
    }, () =&gt; {
        // See next step
    }
);
</code></pre>

<p>Then we subscribe to the Session events that interest us.</p>
<pre><code class="javascript">// --- 3) Specify the actions when events take place in the session ---


var mySession = this.state.session;

    // On every new Stream received...
mySession.on('streamCreated', (event) =&gt; {
    // Subscribe to the Stream to receive it. Second parameter is undefined
    // so OpenVidu doesn't create an HTML video by its own
    var subscriber = mySession.subscribe(event.stream, undefined);

    //We use an auxiliary array to push the new stream
    var subscribers = this.state.subscribers;

    subscribers.push(subscriber);

    // Update the state with the new subscribers
    this.setState({
        subscribers: subscribers,
    });
});

    // On every Stream destroyed...
mySession.on('streamDestroyed', (event) =&gt; {
    event.preventDefault();

    // Remove the stream from 'subscribers' array
    this.deleteSubscriber(event.stream.streamManager);
});

// See next step
</code></pre>

<p>Here we subscribe to the Session events that interest us. As we are using React Native framework, a good approach for managing the remote media streams is to loop across an array of them, feeding a common component with each <code>Subscriber</code> object and let it manage its video. This component will be <em>RTCView</em> and is provided from <strong><em>react-native-webrtc</em></strong> library. To do this, we need to store each new Subscriber we received in array <code>subscribers</code>, and we must remove from it every deleted subscriber whenever it is necessary. To achieve this, we use the following events:</p>
<ul>
<li>
<p><code>streamCreated</code>: for each new Stream received by the Session object, we subscribe to it and store the returned Subscriber object in our <code>subscribers</code> array. Method <code>session.subscribe</code> has <em>undefined</em> as second parameter so OpenVidu doesn't insert and HTML video element in the DOM due to,  as it is a native application, the DOM does not exist.  The render method of <em>App.js</em> will show the new video, as it contains a .map js function, declaring a <em>RTCView</em> for each subscriber. We get the reference to RTCView and we will run openvidu-browser method <em>addVideoElement</em>, passing the reference of the RTCView when it is defined.</p>
<pre><code>{this.state.subscribers.map((item, index) =&gt; {
    if(!!item){
        return (
            &lt;View key={index}&gt;
                &lt;Text&gt;{this.getNicknameTag(item.stream)}&lt;/Text&gt;
                &lt;RTCView zOrder={0}  objectFit="cover" style={styles.remoteView}  ref={(rtcVideo) =&gt; {
                    if (!!rtcVideo){
                        item.addVideoElement(rtcVideo);
                    }
                }} /&gt;
            &lt;/View&gt;
        )
}
</code></pre>
</li>
<li>
<p><code>streamDestroyed</code>: for each Stream that has been destroyed from the Session object (which means a user has left the video-call), we remove the associated Subscriber from <code>subscribers</code> array, so React will automatically delete the required <em>RTCView</em> component. </p>
</li>
</ul>
<hr />
<h4 id="get-a-token-from-openvidu-server">Get a <em>token</em> from OpenVidu Server</h4>
<div style="
    display: table;
    border: 2px solid #0088aa9e;
    border-radius: 5px;
    width: 100%;
    margin-top: 30px;
    margin-bottom: 25px;
    padding: 5px 0 5px 0;
    background-color: rgba(0, 136, 170, 0.04);"><div style="display: table-cell; vertical-align: middle;">
    <i class="icon ion-android-alert" style="
    font-size: 50px;
    color: #0088aa;
    display: inline-block;
    padding-left: 25%;
"></i></div>
<div style="
    vertical-align: middle;
    display: table-cell;
    padding-left: 20px;
    padding-right: 20px;
    ">
    <strong>WARNING</strong>: This is why this tutorial is an insecure application. We need to ask OpenVidu Server for a user token in order to connect to our session. <strong>This process should entirely take place in our server-side</strong>, not in our client-side. But due to the lack of an application backend in this tutorial, the Angular front itself will perform the POST operations to OpenVidu Server
</div>
</div>

<pre><code class="typescript">// --- 4) Connect to the session with a valid user token ---

// 'getToken' method is simulating what your server-side should do.
// 'token' parameter should be retrieved and returned by your own backend
this.getToken().then((token) =&gt; {
    // See next point to see how to connect to the session using 'token'
});
</code></pre>

<p>Now we need a token from OpenVidu Server. In a production environment we would perform this operations in our application backend, by making use of the <em><a href="../../reference-docs/REST-API/" target="_blank">REST API</a></em>, <em><a href="../../reference-docs/openvidu-java-client/" target="_blank">OpenVidu Java Client</a></em> or <em><a href="../../reference-docs/openvidu-node-client/" target="_blank">OpenVidu Node Client</a></em>. Here we have implemented the POST requests to OpenVidu Server in a method <code>getToken()</code> that returns a Promise with the token, using <code>fetch</code> library. Without going into too much detail, this method performs two POST requests to OpenVidu Server, passing OpenVidu Server secret to authenticate them:</p>
<ul>
<li>First request performs a POST to <code>/api/sessions</code> (we send a <code>customSessionId</code> field to name the session with our <code>mySessionId</code> value retrieved from HTML input)</li>
<li>Second request performs a POST to <code>/api/tokens</code> (we send a <code>session</code> field to assign the token to this same session)</li>
</ul>
<p>You can inspect this method in detail in the <a href="https://github.com/OpenVidu/openvidu-tutorials/blob/master/openvidu-react-native/App.js#L268" target="_blank">GitHub repo</a>.</p>
<hr />
<h4 id="connect-to-the-session">Connect to the session:</h4>
<pre><code class="javascript">// --- 4) Connect to the session with a valid user token ---

// 'getToken' method is simulating what your server-side should do.
// 'token' parameter should be retrieved and returned by your own backend
this.getToken().then((token) =&gt; {
    // First param is the token got from OpenVidu Server. Second param can be retrieved by every user on event
    // 'streamCreated' (property Stream.connection.data), and will be appended to DOM as the user's nickname
    mySession.connect(token, { clientData: this.state.myUserName })
        .then(() =&gt; {
            if (Platform.OS == 'android') {
                this.checkAndroidPermissions();
            }

            // --- 5) Get your own camera stream ---
            if (this.state.role !== 'SUBSCRIBER') {
                // Init a publisher passing undefined as targetElement (we don't want OpenVidu to insert a video
                // element: we will manage it on our own) and with the desired properties
                let publisher = this.OV.initPublisher(undefined, {
                    audioSource: undefined, // The source of audio. If undefined default microphone
                    videoSource: undefined, // The source of video. If undefined default webcam
                    publishAudio: true, // Whether you want to start publishing with your audio unmuted or not
                    publishVideo: true, // Whether you want to start publishing with your video enabled or not
                    resolution: '640x480', // The resolution of your video
                    frameRate: 30, // The frame rate of your video
                    insertMode: 'APPEND', // How the video is inserted in the target element 'video-container'
                });

                // --- 6) Publish your stream ---

                // Set the main video in the page to display our webcam and store our Publisher
                this.setState({
                    mainStreamManager: publisher
                });
                mySession.publish(publisher);
            }

        })
        .catch((error) =&gt; {
            console.log('There was an error connecting to the session:', error.code, error.message);
        });
    })
    .catch((error) =&gt; console.log('Error', error));
</code></pre>

<p>In <code>session.connect</code> method first param is the recently retrieved user token. Second param is the value every user will receive in <code>event.stream.connection.data</code> property on <code>streamCreated</code> event. (this value will be used to show the user's nickname to the his video).</p>
<p>If the method succeeds we will call to <code>checkAndroidPermissions()</code> method. This method requests and checks the device permissions that our app currently has in the device. Once the permissions have been resolved, the <code>OV.initPublisher()</code> method will be called. For iOS  and web platforms, permissions will be handled automatically when camera and microphone access are requested. No need for extra steps in these cases, so we directly initialize our Publisher object.</p>
<p>We do further talk about Android permissions under section <a href="#android-specific-requirements">Android specific requirements</a>.</p>
<h4 id="finally-publish-your-webcam-calling-ovinitpublisher-method">Finally publish your webcam calling <code>OV.initPublisher()</code> method:</h4>
<pre><code class="javascript">let publisher = this.OV.initPublisher(undefined, {
    audioSource: undefined, // The source of audio. If undefined default microphone
    videoSource: undefined, // The source of video. If undefined default webcam
    publishAudio: true, // Whether you want to start publishing with your audio unmuted or not
    publishVideo: true, // Whether you want to start publishing with your video enabled or not
    resolution: '640x480', // The resolution of your video
    frameRate: 30, // The frame rate of your video
    insertMode: 'APPEND', // How the video is inserted in the target element 'video-container'
});

// --- 6) Publish your stream ---

// Set the main video in the page to display our webcam and store our Publisher
this.setState({
    mainStreamManager: publisher
});
mySession.publish(publisher);
</code></pre>

<p>We now proceed to publish our webcam to the session. To do so we get a <code>Publisher</code> object with the desired properties and publish it to the Session through <code>Session.publish()</code> method. The rest of users will receive our Stream object and will execute their <code>streamCreated</code> event.</p>
<p>Also we store the Publisher object under <code>this.state.mainStreamManager</code> variable. This way our webcam will be appended along all remote subscribers, in exactly the same way they are shown.</p>
<pre><code>&lt;View style={styles.container}&gt;
    &lt;Text&gt;Session: {this.state.mySessionId}&lt;/Text&gt;
    &lt;Text&gt;{this.getNicknameTag(this.state.mainStreamManager.stream)}&lt;/Text&gt;
    &lt;RTCView zOrder={0}  objectFit=&quot;cover&quot;
        ref={(rtcVideo) =&gt; {
            if (!!rtcVideo) {
                this.state.mainStreamManager.addVideoElement(rtcVideo);
            }
        }}
        style={styles.selfView}
    /&gt;
&lt;/View&gt;
</code></pre>

<hr />
<h4 id="leaving-the-session">Leaving the session</h4>
<p>Whenever we want a user to leave the session, we just need to call <code>session.disconnect</code> method in <code>app.component.ts</code>:</p>
<pre><code class="javascript">leaveSession() {
    // --- 7) Leave the session by calling 'disconnect' method over the Session object ---

    const mySession = this.state.session;

    if (mySession) {
        mySession.disconnect();
    }

    // Empty all properties...
    this.OV = null;
    this.setState({
        session: undefined,
        subscribers: [],
        mySessionId: 'SessionReactNative',
        myUserName: 'Participant' + Math.floor(Math.random() * 100),
        mainStreamManager: undefined,
        publisher: undefined,
    });
}
</code></pre>

<p><br></p>
<h2 id="android-specific-requirements">Android specific requirements</h2>
<p>Android apps need to actively ask for permissions in the code to access camera and microphone using <em><a href="https://github.com/react-native-webrtc/react-native-webrtc">react-native-webrtc</a></em> plugin. By following steps below we have been able to properly set up the optimal configuration your React Native app will need to work along OpenVidu.</p>
<p>These configurations are already included in this <strong>openvidu-react-native</strong> project, so if you start from here no further configurations are needed. Otherwise, if you want to <strong>start a new project with React Native and OpenVidu</strong>, you should follow these simple steps:</p>
<p>1) In <code>android/app/src/main/AndroidManifest.xml</code> add these permissions</p>
<pre><code class="xml">&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;
&lt;uses-feature android:name=&quot;android.hardware.camera&quot; /&gt;
&lt;uses-feature android:name=&quot;android.hardware.camera.autofocus&quot;/&gt;

&lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot;/&gt;
&lt;uses-permission android:name=&quot;android.permission.MODIFY_AUDIO_SETTINGS&quot; /&gt;
&lt;uses-permission android:name=&quot;android.permission.RECORD_AUDIO&quot; /&gt;
&lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot; /&gt;
&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;
</code></pre>

<p>2) In <code>android/settings.gradle</code>, include WebRTCModule</p>
<pre><code class="javascript">include ':WebRTCModule', ':app'
project(':WebRTCModule').projectDir = new File(rootProject.projectDir, '../node_modules/openvidu-browser/node_modules/react-native-webrtc/android')
</code></pre>

<p>3) In <code>android/app/build.gradle</code>, add WebRTCModule to dependencies</p>
<pre><code class="javascript">dependencies {
    implementation project(':WebRTCModule')
    ...
}
</code></pre>

<p>4) In <code>android/app/src/main/java/com/xxx/MainApplication.java</code></p>
<pre><code class="java">@Override
protected List&lt;ReactPackage&gt; getPackages() {
    return Arrays.&lt;ReactPackage&gt;asList(
        new MainReactPackage(),
        new WebRTCModulePackage() // &lt;-- Add this line
    );
}
</code></pre>

<h2 id="ios-specific-requirements">iOS specific requirements</h2>
<p>iOS apps need to include the WebRTC modules from react-native-webrtc plugin. We will do it by following the steps bellow.</p>
<p>These configurations are already included in this <strong>openvidu-react-native project</strong>, so if you start from here no further configurations are needed. Otherwise, if you want to <strong>start a new project with React Native and OpenVidu</strong>, you should follow these simple steps:</p>
<p>1) Add these files into your project</p>
<ul>
<li>in Xcode: Right click on <code>Libraries</code> and  <code>Add Files to {project}</code></li>
<li>Go to <code>node_modules/openvidu-browser/node_modules/react-native-webrtc/ios/RCTWebRTC.xcodeproj</code> and click on <code>Add</code></li>
<li>Also add <code>node_modules/react-native-webrtc/ios/WebRTC.framework</code> to <code>Frameworks</code> folder</li>
</ul>
<div class="row no-margin row-gallery">
    <div class="col-md-12">
        <a data-fancybox="gallery" href="/img/tutorials/xcode1.png">
        <img class="img-responsive" src="/img/tutorials/xcode1.png">
    </a>
    </div>
</div>

<p>2) Add Library Search Path</p>
<ul>
<li>Select <strong>Build Settings</strong> section and find <code>Search Paths</code></li>
<li>Edit both <strong>Framework Search Paths</strong> and <strong>Library Search Paths</strong> adding <code>$(SRCROOT)/../node_modules/openvidu-browser/node_modules/react-native-webrtc/ios</code> with <code>recursive</code></li>
</ul>
<div class="row no-margin row-gallery">
    <div class="col-md-12">
        <a data-fancybox="gallery" href="/img/tutorials/xcode2.png">
        <img class="img-responsive" src="/img/tutorials/xcode2.png">
    </a>
    </div>
</div>

<p>3) Change General Setting and Embed Framework</p>
<ul>
<li>Go to <strong>General</strong> section and change <strong>Deployment Target</strong> to <code>8.0</code></li>
<li>Add <strong>Embedded Binaries</strong> like below:</li>
</ul>
<div class="row no-margin row-gallery">
    <div class="col-md-12">
        <a data-fancybox="gallery" href="/img/tutorials/xcode3.png">
        <img class="img-responsive" src="/img/tutorials/xcode3.png">
    </a>
    </div>
</div>

<p>4) Link/Include Necessary Libraries</p>
<ul>
<li>Go to <strong>Build Phases</strong> tab, open <strong>Link Binary With Libraries</strong></li>
<li>Add <code>libRCTWebRTC.a</code></li>
<li>Make sure <code>WebRTC.framework</code> is linked</li>
<li>Under <strong>Build setting</strong> set <strong>Dead Code Stripping</strong> to <code>No</code> also under <strong>Build Options</strong> set <strong>Enable Bitcode</strong> to <code>No</code> as well</li>
</ul>
<p>5) Add Permissions
<em> Navigate to <code>&lt;ProjectFolder&gt;/ios/&lt;ProjectName&gt;/</code>
</em> Edit <strong>Info.plist</strong> and add the following lines</p>
<pre><code class="xml">&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;
&lt;string&gt;Camera Permission&lt;/string&gt;
&lt;key&gt;NSMicrophoneUsageDescription&lt;/key&gt;
&lt;string&gt;Microphone Permission&lt;/string&gt;
</code></pre>

<div style="
    display: table;
    border: 2px solid #0088aa9e;
    border-radius: 5px;
    width: 100%;
    margin-top: 30px;
    margin-bottom: 25px;
    padding: 5px 0 5px 0;
    background-color: rgba(0, 136, 170, 0.04);"><div style="display: table-cell; vertical-align: middle;">
    <i class="icon ion-android-alert" style="
    font-size: 50px;
    color: #0088aa;
    display: inline-block;
    padding-left: 25%;
"></i></div>
<div style="
    vertical-align: middle;
    display: table-cell;
    padding-left: 20px;
    padding-right: 20px;
    ">
<strong>INFO: </strong>react-native-webrtc provide us more information about these requeriments <a href="https://github.com/react-native-webrtc/react-native-webrtc/blob/master/Documentation/AndroidInstallation.md">here</a>
</div>
</div>

<p><br></p>
<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.js"></script>
<script>
  $().fancybox({
    selector : '[data-fancybox]',
    infobar : true,
    arrows : false,
    loop: true,
    protect: true,
    transitionEffect: 'slide',
    buttons : [
        'close'
    ],
    clickOutside : 'close',
    clickSlide   : 'close',
  });
</script></p> 
						</div>
					</div> <footer>
<hr>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../openvidu-electron/" class="btn btn-xs btn-primary float-right" title="openvidu-electron">Next &raquo;<span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../openvidu-ionic/" class="btn btn-xs btn-primary" title="openvidu-ionic"><span class="icon icon-circle-arrow-left"></span> &laquo; Prev</a>
      
    </div>
  


  
  <div id="edit-github">
  
	  <a href="https://github.com/OpenVidu/openvidu.io-docs/blob/master/docs/tutorials/openvidu-react-native.md"><i class="icon ion-social-github"></i> Edit Documentation on GitHub</a>
  
  </div>
</footer> 
				</div>
			</div>
		</section>
</div>